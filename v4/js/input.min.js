/*
	Advanced Custom Fields: Validated Field
	Justin Silver, http://justin.ag
	DoubleSharp, http://doublesharp.com
*/
var vf={valid:!1,$el:!1,reclick:!1,debug:!1,drafts:!0};"undefined"==typeof acf.o&&(acf.o={}),function(e){e(document).ready(function(){function t(i,t){function a(i,t,a){if(vf.valid=!0,i)for(var d=0;d<i.length;d++){var s=i[d];s.valid||(vf.valid=!1,msg=e("<div/>").html(s.message).text(),input=e('[name="'+s.id.replace("[","\\[").replace("]","\\]")+'"]'),input.closest(".validated-field").append('<span class="acf-error-message"><i class="bit"></i>'+msg+"</span>"),field=input.closest(".field"),field.addClass("error"),field.find(".widefat").css("width","100%"))}e("#ajax-loading").attr("style",""),e(".submitbox .spinner").hide(),e(".submitbox .button").removeClass("button-primary-disabled").removeClass("disabled"),vf.valid?vf.debug&&(vf.valid=confirm(vf_l10n.debug)):(t.before('<div id="acfvf_message" class="error"><p>'+vf_l10n.message+"</p></div>"),t.find(".field_type-validated_field .acf-error-message").show()),vf.valid&&a.trigger("click")}if(vf.valid=!1,!t)return!1;if("options"!=acf.o.post_id&&!vf.drafts&&"publish"!=t.attr("id"))return!0;var d=[];if(i.find(".field_type-validated_field").each(function(){div=e(this);var i=!0;if(div.is(":hidden")&&(i=!1,div.hasClass("acf-tab_group-hide"))){i=!0;var t=div.prevAll(".field_type-tab:first"),a=div.prevAll(".acf-tab-wrap:first");t.hasClass("acf-conditional_logic-hide")?i=!1:$tab=a.find('.acf-tab-button[data-key="'+t.attr("data-field_key")+'"]')}if(div.hasClass("acf-conditional_logic-hide")&&(i=!1),div.closest(".postbox.acf-hidden").exists()&&(i=!1),i){if(div.find(".acf_wysiwyg").exists()&&"object"==typeof tinyMCE){var s=div.find(".wp-editor-area").attr("id"),f=tinyMCE.get(s);field={id:div.find(".wp-editor-area").attr("name"),value:f.getContent()}}else if(div.find('.acf_relationship, input[type="radio"], input[type="checkbox"]').exists())sel='.acf_relationship .relationship_right input, input[type="radio"]:checked, input[type="checkbox"]:checked',field={id:div.find('input[type="hidden"], '+sel).attr("name"),value:[]},div.find(sel).each(function(){field.value.push(e(this).val())});else{var r=div.find('input[type="text"], input[type="email"], input[type="number"], input[type="hidden"], textarea, select');r.exists()&&(field={id:r.attr("name"),value:r.val()})}d.push(field)}}),e(".acf_postbox:hidden").remove(),d.length){var s="";return e("#profile-page").length?(post_id=e("#user_id").val(),s="user_"):post_id="options"==acf.o.post_id?"options":e(vf.frontend?"input[name=post_id]":"#post_ID").val(),e.ajax({url:ajaxurl,data:{action:"validate_fields",post_id:s+post_id,click_id:t.attr("id"),frontend:vf.frontend,fields:d},type:"POST",dataType:"json",success:function(e){a(e,i,t)},error:function(){a(d,i,t)}}),!1}return vf.valid=!0,!0}e("#profile-page").addClass("acf_postbox"),e('form.acf-form input[type="submit"]').addClass("button button-primary button-large");var a=acf.fields.tab.refresh;acf.fields.tab.refresh=function(){for(result=a.apply(this,arguments),i=0;i<arguments.length;i++)e(arguments[i]).trigger("acf/fields/tab/refresh",[arguments]);return result},inputSelector='input[type="text"], input[type="hidden"], textarea, select, input[type="checkbox"]:checked',e(document).on("change",inputSelector,function(){vf.valid=!1}),e(document).on("change, keypress, focus",inputSelector,function(){e(this).closest(".field").removeClass("error")}),e(document).on("click","form#post .button, form#post input[type=submit], form#your-profile input[type=submit], form.acf-form input[type=submit]",function(){vf.$el=e(this),vf.reclick&&(vf.reclick=!1,vf.$el.trigger("click"))}),e(document).on("submit","form#post, form#your-profile, form.acf-form",function(){return e(".field_type-validated_field").find(".acf-error-message").remove(),e(this).siblings("#acfvf_message, #message").remove(),acf.validation.status?vf.$el?vf.valid||t(e(this),vf.$el):(vf.reclick=!0,!1):!1})})}(jQuery);